QUESTION 25 import pandas as pd
import numpy as np

# Load dataset
df = pd.read_csv("C:\\Users\\hp\\Downloads\\Datasets\\Datasets\\Diabetes.csv")

print("\nOriginal Dataset Shape:", df.shape)
print("\nPreview of Dataset:\n", df.head())

# ---------------- DATA CLEANING ---------------- #

# 1. Identify missing values
print("\nMissing Values Before Cleaning:\n")
print(df.isnull().sum())

# 2. Replace zeros with NaN for specific columns where 0 cannot exist
cols_with_zero = ['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']
df[cols_with_zero] = df[cols_with_zero].replace(0, np.nan)

# Check again after replacement
print("\nMissing Values After Converting 0 to NaN:\n")
print(df.isnull().sum())

# 3. Fill missing values
# Numerical â†’ fill with mean
df.fillna(df.mean(), inplace=True)

print("\nMissing Values After Filling:\n")
print(df.isnull().sum())

# Remove duplicates
df.drop_duplicates(inplace=True)
print("\nDataset Shape After Removing Duplicates:", df.shape)


# ---------------- DATA TRANSFORMATION ---------------- #

# 1. Scaling numerical values (Min-Max Normalization example)
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
numeric_cols = df.select_dtypes(include=['int64', 'float64']).columns
df[numeric_cols] = scaler.fit_transform(df[numeric_cols])

print("\nData after Min-Max Scaling:\n")
print(df.head())

# 2. Encoding categorical variables (if any exist)
from sklearn.preprocessing import LabelEncoder

cat_cols = df.select_dtypes(include=['object']).columns
for col in cat_cols:
    df[col] = LabelEncoder().fit_transform(df[col])

print("\nData Types After Transformation:\n")
print(df.dtypes)

# Final summary
print("\nFinal Dataset Summary Statistics:\n")
print(df.describe())
